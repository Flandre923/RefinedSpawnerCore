# æµä½“å‚¨ç½å®ç°æ€»ç»“

## æ¦‚è¿°

æˆ‘å·²ç»æˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„æµä½“å‚¨ç½ç³»ç»Ÿï¼Œæ”¯æŒNeoForgeçš„æµä½“APIï¼Œå¹¶ä¸æ¨¡æ‹Ÿå‡çº§ç³»ç»Ÿå®Œç¾é›†æˆã€‚

## æ ¸å¿ƒç»„ä»¶

### 1. FluidTankBlock (æµä½“å‚¨ç½æ–¹å—)
- **æ–‡ä»¶**: `src/main/java/com/example/examplemod/block/FluidTankBlock.java`
- **ç‰¹æ€§**:
  - æ”¯æŒæ–¹å‘æ€§æ”¾ç½®
  - è‡ªå®šä¹‰ç¢°æ’ç®±ä¾¿äºç®¡é“è¿æ¥
  - å³é”®æ˜¾ç¤ºæµä½“ä¿¡æ¯
  - å®Œæ•´çš„æ–¹å—çŠ¶æ€ç®¡ç†

### 2. FluidTankBlockEntity (æµä½“å‚¨ç½æ–¹å—å®ä½“)
- **æ–‡ä»¶**: `src/main/java/com/example/examplemod/blockentity/FluidTankBlockEntity.java`
- **åŠŸèƒ½**:
  - 16000 mBå®¹é‡ (16æ¡¶)
  - å®Œæ•´çš„NeoForgeæµä½“APIæ”¯æŒ
  - è‡ªåŠ¨åŒæ­¥åˆ°å®¢æˆ·ç«¯
  - NBTæ•°æ®ä¿å­˜å’ŒåŠ è½½
  - æœåŠ¡å™¨ç«¯Tickå¤„ç†

### 3. CapabilityHandler (èƒ½åŠ›æ³¨å†Œ)
- **æ–‡ä»¶**: `src/main/java/com/example/examplemod/capability/CapabilityHandler.java`
- **åŠŸèƒ½**:
  - æ³¨å†Œæµä½“å¤„ç†èƒ½åŠ›
  - æ”¯æŒæ‰€æœ‰æ–¹å‘çš„æµä½“äº¤äº’
  - è‡ªåŠ¨ç®¡é“è¿æ¥æ”¯æŒ

## NeoForge APIé›†æˆ

### ğŸ”§ æµä½“å¤„ç†èƒ½åŠ›
```java
// æ³¨å†Œæµä½“å¤„ç†èƒ½åŠ›
event.registerBlockEntity(
    Capabilities.FluidHandler.BLOCK,
    ExampleMod.FLUID_TANK_BLOCK_ENTITY.get(),
    (blockEntity, side) -> blockEntity.getFluidHandler(side)
);
```

### ğŸ’§ æµä½“æ“ä½œAPI
```java
// å¡«å……æµä½“
public int fill(FluidStack resource, IFluidHandler.FluidAction action)

// æŠ½å–æµä½“
public FluidStack drain(FluidStack resource, IFluidHandler.FluidAction action)
public FluidStack drain(int maxDrain, IFluidHandler.FluidAction action)

// æŸ¥è¯¢çŠ¶æ€
public boolean isEmpty()
public boolean isFull()
public float getFillPercentage()
```

## æ¨¡æ‹Ÿå‡çº§é›†æˆ

### ğŸ¯ æ™ºèƒ½æµä½“æ¨é€
```java
// åœ¨ ExperienceFluidHelper ä¸­
public static boolean storeExperienceFluid(ServerLevel level, BlockPos spawnerPos, int experience) {
    // 1. ä¼˜å…ˆæ¨é€åˆ°æµä½“å‚¨ç½
    // 2. å…¶æ¬¡æ¨é€åˆ°å…¶ä»–æµä½“å®¹å™¨
    // 3. æœ€ååœ¨ä¸–ç•Œä¸­æ”¾ç½®æµä½“æ–¹å—
}
```

### ğŸ“ ä¼˜å…ˆçº§ç³»ç»Ÿ
1. **æµä½“å‚¨ç½** (FluidTankBlockEntity) - æœ€é«˜ä¼˜å…ˆçº§
2. **å…¶ä»–æµä½“å®¹å™¨** - æ™®é€šä¼˜å…ˆçº§
3. **ä¸–ç•Œæ”¾ç½®** - å¤‡ç”¨æ–¹æ¡ˆ

### ğŸ” æ™ºèƒ½æœç´¢
- **æœç´¢èŒƒå›´**: 5x5x5 åŒºåŸŸ
- **è‡ªåŠ¨è¯†åˆ«**: åŒºåˆ†æµä½“å‚¨ç½å’Œå…¶ä»–å®¹å™¨
- **è°ƒè¯•ä¿¡æ¯**: è¯¦ç»†çš„æ—¥å¿—è¾“å‡º

## ç®¡é“å…¼å®¹æ€§

### âœ… æ”¯æŒçš„æ“ä½œ
- **è¾“å…¥**: ç®¡é“å¯ä»¥å‘å‚¨ç½è¾“å…¥æµä½“
- **è¾“å‡º**: ç®¡é“å¯ä»¥ä»å‚¨ç½æŠ½å–æµä½“
- **åŒå‘**: åŒæ—¶æ”¯æŒè¾“å…¥å’Œè¾“å‡º
- **å¤šæ–¹å‘**: æ”¯æŒ6ä¸ªé¢çš„è¿æ¥

### ğŸ”Œ å…¼å®¹çš„æ¨¡ç»„
- ä»»ä½•ä½¿ç”¨NeoForgeæµä½“APIçš„ç®¡é“æ¨¡ç»„
- æ”¯æŒIFluidHandlerçš„æ‰€æœ‰è®¾å¤‡
- åŸç‰ˆå’Œæ¨¡ç»„çš„æµä½“æ¡¶

## ä½¿ç”¨æµç¨‹

### ğŸ­ è‡ªåŠ¨åŒ–è®¾ç½®
1. **æ”¾ç½®åˆ·æ€ªå™¨** + **å®‰è£…æ¨¡æ‹Ÿå‡çº§**
2. **åœ¨é™„è¿‘æ”¾ç½®æµä½“å‚¨ç½** (5æ ¼èŒƒå›´å†…)
3. **è¿æ¥ç®¡é“ç³»ç»Ÿ** (å¯é€‰)
4. **å¯åŠ¨åˆ·æ€ªå™¨** â†’ è‡ªåŠ¨ç”Ÿæˆç»éªŒæµä½“

### ğŸ“Š ç›‘æ§å’Œç®¡ç†
```java
// å³é”®å‚¨ç½æŸ¥çœ‹ä¿¡æ¯
"Fluid Tank: 8000/16000 mB"
"Fluid: Experience Fluid"
```

### ğŸ”„ æµä½“ä¼ è¾“
- **è¾“å…¥**: ä½¿ç”¨ç»éªŒæ¡¶æˆ–ç®¡é“è¾“å…¥
- **è¾“å‡º**: ä½¿ç”¨ç®¡é“æˆ–å…¶ä»–æµä½“è®¾å¤‡æŠ½å–
- **å­˜å‚¨**: é•¿æœŸå­˜å‚¨å¤§é‡ç»éªŒæµä½“

## æŠ€æœ¯ç‰¹æ€§

### ğŸ’¾ æ•°æ®æŒä¹…åŒ–
```java
// NBTä¿å­˜å’ŒåŠ è½½
@Override
protected void saveAdditional(CompoundTag tag, HolderLookup.Provider registries) {
    tag.put("FluidTank", fluidTank.writeToNBT(registries, new CompoundTag()));
}
```

### ğŸ”„ å®¢æˆ·ç«¯åŒæ­¥
```java
// è‡ªåŠ¨åŒæ­¥æµä½“å˜åŒ–
private void syncToClient() {
    if (level != null && !level.isClientSide) {
        level.sendBlockUpdated(worldPosition, getBlockState(), getBlockState(), 3);
    }
}
```

### âš¡ æ€§èƒ½ä¼˜åŒ–
- åªåœ¨æµä½“é‡å˜åŒ–æ—¶åŒæ­¥
- æœåŠ¡å™¨ç«¯Tickä¼˜åŒ–
- æ™ºèƒ½æœç´¢ç¼“å­˜

## æ‰©å±•åŠŸèƒ½

### ğŸ¨ è§†è§‰æ”¹è¿› (æœªæ¥)
- æµä½“æ¸²æŸ“æ˜¾ç¤º
- å¡«å……ç™¾åˆ†æ¯”æŒ‡ç¤ºå™¨
- æµä½“ç±»å‹é¢œè‰²æ˜¾ç¤º

### ğŸ”§ åŠŸèƒ½æ‰©å±• (æœªæ¥)
- GUIç•Œé¢
- æµä½“è¿‡æ»¤å™¨
- è‡ªåŠ¨è¾“å‡ºæ¨¡å¼
- çº¢çŸ³æ§åˆ¶

### ğŸ“ˆ å®¹é‡å‡çº§ (æœªæ¥)
- ä¸åŒç­‰çº§çš„å‚¨ç½
- å®¹é‡å‡çº§æ¨¡å—
- å¤šæ–¹å—å‚¨ç½ç»“æ„

## é…ç½®å’Œè°ƒæ•´

### ğŸ”§ å®¹é‡è°ƒæ•´
```java
// åœ¨ FluidTankBlockEntity ä¸­
public static final int CAPACITY = 16000; // å¯è°ƒæ•´å®¹é‡
```

### ğŸ“ æœç´¢èŒƒå›´è°ƒæ•´
```java
// åœ¨ ExperienceFluidHelper ä¸­
int searchRange = 5; // å¯è°ƒæ•´æœç´¢èŒƒå›´
```

### ğŸ¯ ä¼˜å…ˆçº§è°ƒæ•´
å¯ä»¥ä¿®æ”¹ `findNearbyFluidHandlers` æ–¹æ³•æ¥è°ƒæ•´ä¸åŒå®¹å™¨çš„ä¼˜å…ˆçº§ã€‚

## æ€»ç»“

æµä½“å‚¨ç½ç³»ç»Ÿç°åœ¨å®Œå…¨é›†æˆï¼š

- âœ… **å®Œæ•´çš„NeoForge APIæ”¯æŒ**: ç®¡é“ã€æ¡¶ã€è‡ªåŠ¨åŒ–è®¾å¤‡
- âœ… **æ™ºèƒ½æµä½“æ¨é€**: æ¨¡æ‹Ÿå‡çº§è‡ªåŠ¨æ¨é€ç»éªŒæµä½“
- âœ… **ä¼˜å…ˆçº§ç³»ç»Ÿ**: ä¼˜å…ˆä½¿ç”¨æµä½“å‚¨ç½
- âœ… **åŒå‘å…¼å®¹**: æ”¯æŒè¾“å…¥å’Œè¾“å‡º
- âœ… **æ•°æ®æŒä¹…åŒ–**: é‡å¯åä¿æŒæµä½“å†…å®¹
- âœ… **æ€§èƒ½ä¼˜åŒ–**: é«˜æ•ˆçš„åŒæ­¥å’Œæœç´¢

ç°åœ¨ä½ å¯ä»¥å»ºç«‹å®Œæ•´çš„ç»éªŒæµä½“è‡ªåŠ¨åŒ–ç³»ç»Ÿï¼šåˆ·æ€ªå™¨ â†’ æµä½“å‚¨ç½ â†’ ç®¡é“ç½‘ç»œ â†’ ç»éªŒå¤„ç†è®¾å¤‡ï¼
